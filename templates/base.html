{% load static %}

<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
  <script src="https://kit.fontawesome.com/7283992a6b.js" crossorigin="anonymous"></script>

  {% block extra_head %}{% endblock %}

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>

  <link href="{% static 'base.css' %}" type="text/css" rel="stylesheet" />
  <link rel="icon" href="{% static 'logo.png' %}">
  <link rel="stylesheet" href="{% static 'portfolio/avatar.css' %}">
</head>

<!-- <div class="gradient-rect"></div> -->
<nav class="navbar fixed-top">
  <div class="container-fluid p-0">
    <a href="{% url 'main-page' %}" class="p-0">
      <img src="{% static 'logo.png' %}" class="navbar-brand navbar-img mainmenu-toggler m-0" />
    </a>
    <div class="dropdown">
      <a id="navbarDropdown" data-bs-toggle="dropdown" href="#" class="no-focus">
      <div class='navbar-brand navbar-img mainmenu-toggler avatar' style="background-image: url('{{user.avatar.url}}'); width: 50px;height: 50px;"></div>
    </a>
    <ul class="dropdown-menu dropdown-menu-lg-end animate slideIn" aria-labelledby="navbarDropdown">
      <li>
        <input type="search" class="search" placeholder="Search">
      </li>
      <li>
        <hr class="dropdown-divider mx-auto" />
      </li>
      {% if user.is_authenticated %}
      <a class="dropdown-item" href="{% url 'user_profile' user.pk %}">
        <i class="fa-solid fa-user-tie" title="Admin"></i> {{ user.username }}
      </a>
      <li><a class="dropdown-item" href="{% url 'notifications-list' %}">
          <i class="fa-solid fa-bell"></i> Notifications</a></li>
      {% else %}
      <p class="dropdown-item">Guest</p>
      {% endif %}
      <li>
        <hr class="dropdown-divider mx-auto" />
      </li>
      {% if user.is_authenticated %}
      <li>
        <a class="dropdown-item logout-item" href="{% url 'logout' %}">
          <i class="fa-solid fa-right-from-bracket"></i> Logout</a>
      </li>
      {% else %}
      <li><a class="dropdown-item" href="{% url 'login' %}">Login</a></li>
      <li><a class="dropdown-item" href="{% url 'register' %}">Register</a></li>
      {% endif %}
    </ul>
  </div>
</nav>

<ul class="dropdown-menu mainmenu" aria-labelledby="navbarDropdown">
  <li>
    <a class="dropdown-item mainmenu-item" href="{% url 'forum_app:forum-start' %}">Forum
      <i class="fa-solid fa-comments"></i>
    </a>
  </li>
  <li>
    <a class="dropdown-item mainmenu-item" href="{% url 'calendar' %}">Calendar
      <i class="fa-solid fa-calendar"></i>
    </a>
  </li>
  <li>
    <a class="dropdown-item mainmenu-item" href="{% url 'gallery-start' %}">Gallery
      <i class="fa-solid fa-image"></i>
    </a>
  </li>
  <li>
    <a class="dropdown-item mainmenu-item" href="{% url 'calendar' %}">Calendar
      <i class="fa-solid fa-calendar"></i>
    </a>
  </li>
  <li>
    <a class="dropdown-item mainmenu-item" href="{% url 'forum_app:forum-start' %}">Forum
      <i class="fa-solid fa-comments"></i>
    </a>
  </li>
  <li>
    <a class="dropdown-item mainmenu-item" href="{% url 'calendar' %}">Calendar
      <i class="fa-solid fa-calendar"></i>
    </a>
  </li>
  <li>
    <a class="dropdown-item mainmenu-item" href="{% url 'forum_app:forum-start' %}">Forum
      <i class="fa-solid fa-comments"></i>
    </a>
  </li>
  <li>
    <a class="dropdown-item mainmenu-item" href="{% url 'calendar' %}">Calendar
      <i class="fa-solid fa-calendar"></i>
    </a>
  </li>

</ul>

<script>
  const toggler = document.querySelector(".mainmenu-toggler");
  const menu = document.querySelector(".mainmenu");

  let hideMenuTimer;

  function showMenu() {
    clearTimeout(hideMenuTimer);
    menu.classList.remove("hide");
    menu.classList.add("show");
  }

  function hideMenu() {
    menu.classList.remove("show");
    menu.classList.add("hide");
  }

  toggler.addEventListener("mouseover", showMenu);
  toggler.addEventListener("mouseout", function (event) {
    if (!menu.contains(event.relatedTarget)) {
      hideMenuWithDelay();
    }
  });

  menu.addEventListener("mouseover", showMenu);
  menu.addEventListener("mouseout", function (event) {
    if (!toggler.contains(event.relatedTarget)) {
      hideMenuWithDelay();
    }
  });

  function hideMenuWithDelay() {
    hideMenuTimer = setTimeout(hideMenu, 200);
  }

</script>
{% block content %} {% endblock %}